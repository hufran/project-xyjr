
<div id="dashboard-coupon">

    <nav class="omit-margin container page-nav">
    <div class="row">
        <a class="col-xs-3 back" ng-href="{{ self.back_path || 'dashboard' }}">
            <param class="glyphicon glyphicon-menu-left">
        </a>

        <span class="col-xs-6 title">{{ picking ? '选择' : '我的' }}红包</span>

        <span class="col-xs-3" ng-if="!picking">&nbsp;</span>
        <a class="col-xs-3 actions" ng-href="{{ self.back_path }}"
           ng-if="picking"
        ><small style="font-size: 80%">不使用红包</small></a>
    </div>
    </nav>

    <div>
        <param ng-model="msg" ng-init="msg = {
            SUCCEED: '兑换成功',
            FAILED: '兑换失败',
        }">
    </div>

    <section class="coupons">
        <ul class="list list-unstyled list-coupon u-off-margin-bottom">
            <li class="item"
                ng-repeat="item in data"
                ng-click="picking && item.status != 'DISABLED' && self.select(item.id)"
                ng-class="[
                    'item-status-' + (item.status | lowercase),
                    'item-type-' + (item.couponPackage.type | lowercase)
                ]"
            >
                <div class="inner">
                    <div class="inner-left">
                        <h4 class="type" ng-switch="item.couponPackage.type">
                            <span ng-switch-when="CASH">现金券</span>
                            <span ng-switch-when="INTEREST">加息券</span>
                            <span ng-switch-when="PRINCIPAL">增值券</span>
                            <span ng-switch-when="REBATE">返现券</span>
                        </h4>

                        <div class="rule">
                            使用范围：固收理财<br>
                            最低投资 {{ item.couponPackage.minimumInvest | number }}元<br>
                            最少 {{ item.couponPackage.minimumDuration }}个月
                        </div>
                    </div>

                    <div class="inner-right">
                        <div class="value" ng-switch="item.couponPackage.type">
                            <span ng-switch-when="INTEREST" class="interest">
                                {{ item.couponPackage.parValue / 100 }}<small>%</small>
                            </span>
                            <span ng-switch-default>
                                <span ng-if="item.couponPackage.parValue >= 10000">
                                    {{ item.couponPackage.parValue / 10000 }}<small>万</small>
                                </span>
                                <span ng-if="!(item.couponPackage.parValue >= 10000)">
                                    {{ item.couponPackage.parValue }}<small>元</small>
                                </span>
                            </span>
                        </div>

                       <div class="expire">
                            <span ng-if="item.couponPackage.timeExpire">
                                有效期至 {{ item.couponPackage.timeExpire | date: "yyyy-MM-dd" }}
                            </span>
                            <span ng-if="!item.couponPackage.timeExpire">有效期至：永不过期</span>
                        </div>

                        <button class="btn btn-sm btn-block btn-redeem"
                                ng-click="self.redeem(item.id)"
                                ng-if="
                                    item.couponPackage.type === 'CASH'
                                 && ['INITIATED', 'PLACED'].indexOf(item.status) > -1
                                "
                                x-gyro-comment
                        >使用</button>
                    </div>
                </div>
            </li>
        </ul>

        <div ng-if="!data.length" class="container">
            <h4 class="alert alert-info text-center">抱歉，您还没有奖券！</h4>
        </div>

        <p ng-if="data.length && self.has_more(data)" class="container">
            <button class="load-more btn btn-default btn-block"
                    ng-click="self.add_more(data)"
            >点击查看更多</button>
        </p>
    </section>

</div>
